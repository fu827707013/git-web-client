# Git 仓库可视化管理工具 - 快速上手指南

本文档帮助您快速启动和运行 Git 仓库可视化管理工具。

---

## 📋 前置条件

在开始之前，请确保您的计算机已安装：

- ✅ **Node.js** 18.0+ （[下载地址](https://nodejs.org/)）
- ✅ **.NET SDK** 10.0+ （[下载地址](https://dotnet.microsoft.com/download)）
- ✅ **Git** 2.40+ （[下载地址](https://git-scm.com/)）

**验证安装**：

```bash
node -v      # 应显示 v18.x.x 或更高
dotnet --version  # 应显示 10.x.x 或更高
git --version     # 应显示 2.40.x 或更高
```

---

## 🚀 快速启动（开发模式）

### 方法一：一键启动脚本（Windows）

项目根目录已包含 `start-dev.bat` 脚本，双击即可启动：

**脚本功能**：
- 自动检查环境依赖
- 首次运行自动安装 npm 包
- 启动后端 API 服务（端口 9002）
- 启动前端开发服务器（端口 9001）
- 启动 Electron 桌面应用

**使用方法**：
```bash
# 在项目根目录
双击 start-dev.bat
```

所有服务会在独立的终端窗口中运行。

---

### 方法二：手动分步启动

#### 步骤 1：安装依赖（仅首次运行）

```bash
# 安装前端依赖
cd git-web
npm install

# 安装后端依赖
cd ../server
dotnet restore
```

#### 步骤 2：启动后端 API

打开**终端 1**：

```bash
cd server
dotnet run --urls "http://localhost:9002"
```

✅ **成功标志**：看到 "Now listening on: http://localhost:9002"

#### 步骤 3：启动前端

打开**终端 2**：

```bash
cd git-web
npm run electron:dev
```

✅ **成功标志**：看到 "Local: http://localhost:9001/"

#### 步骤 4：启动 Electron

打开**终端 3**：

```bash
cd git-web
npm run electron:start
```

✅ **成功标志**：Electron 窗口打开，显示应用界面

---

## 📦 打包发布（生产环境）

### 快速打包方法

使用项目提供的 `build-release.bat` 脚本：

```bash
# 在项目根目录
双击 build-release.bat
```

**脚本会自动执行**：
1. 清理旧的构建文件
2. 发布后端为自包含 .NET 应用
3. 构建前端并打包 Electron 应用
4. 生成 Windows 安装程序

**输出文件**：`git-web/release/Git-仓库管理工具-Setup-1.0.0.exe`

### 手动打包步骤（可选）

#### 1. 发布后端

```bash
cd server
dotnet publish -c Release -r win-x64 --self-contained true -p:PublishSingleFile=false
```

#### 2. 打包前端

```bash
cd git-web
npm run electron:build
```

---

## 🎯 首次使用指南

### 1. 添加 Git 仓库

启动应用后：

1. 点击仓库标签栏的 **"+"** 按钮
2. 在弹出的对话框中：
   - **仓库名称**：输入便于识别的名字（如："我的项目"）
   - **仓库路径**：输入或粘贴本地 Git 仓库路径
   - 示例：`D:\Projects\my-git-repo`
3. 点击 **"添加"**
4. 新仓库会作为 Tab 标签出现在顶部

### 2. 切换和管理仓库

- **切换仓库**：点击顶部的仓库 Tab 标签
- **关闭仓库**：右键 Tab 标签选择"关闭"
- **多仓库管理**：可同时打开多个仓库，通过 Tab 快速切换

### 3. 查看提交历史

1. 选择一个仓库 Tab
2. 左侧导航显示该仓库的分支和状态
3. 主区域显示提交历史列表
4. 支持搜索和筛选功能

### 4. 搜索和筛选

- **按消息搜索**：在搜索框输入关键词，实时过滤
- **按作者筛选**：使用作者下拉框筛选特定开发者的提交
- **分支筛选**：在左侧导航选择特定分支查看

### 5. 查看提交详情

点击任意提交记录后，底部详情面板会显示：

- **提交信息**：作者、日期、SHA、完整提交消息
- **变更文件**：所有变更文件的列表和差异
- **文件树**：树形结构展示，带状态标识

**操作方式**：
- 单击提交：在底部面板查看详情
- 双击提交：展开详细视图
- 右键菜单：更多操作选项

### 6. 下载文件

#### 单个提交下载
- 点击提交记录的 **下载图标**
- 或右键选择"下载此提交的文件"

#### 批量下载
1. 按住 **Ctrl** 点击多个提交
2. 或按住 **Shift** 选择范围
3. 点击工具栏的 **"批量下载"** 按钮

---

## 🛠️ 常见操作

### 界面操作

- **切换主题**：点击顶部工具栏的 **🌙/☀** 图标
- **切换视图**：在左侧导航选择 "All Commits" 或 "Changes"
- **折叠面板**：点击底部详情面板的折叠按钮

### 仓库操作

- **刷新仓库**：点击工具栏的刷新按钮或按 F5
- **关闭仓库**：右键 Tab 标签选择"关闭"
- **重新排序**：拖拽 Tab 标签调整顺序

### 快捷键

- **Ctrl + T**：添加新仓库
- **Ctrl + W**：关闭当前仓库
- **Ctrl + Tab**：切换到下一个仓库
- **F5**：刷新当前仓库
- **Ctrl + F**：搜索提交

---

## ❓ 常见问题

### Q1: 端口被占用怎么办？

**错误提示**：`Port 9001 is already in use`

**解决方法**：

```bash
# 查找占用端口的进程
netstat -ano | findstr "9001"

# 结束进程（替换 <PID> 为实际进程 ID）
taskkill /PID <PID> /F
```

### Q2: Electron 窗口显示空白？

**原因**：后端 API 未启动

**解决方法**：
1. 检查终端 1 是否显示 "Now listening on: http://localhost:9002"
2. 如果没有，手动启动后端
3. 按 **Ctrl + R** 刷新 Electron 窗口

### Q3: 找不到 Git 仓库？

**错误提示**：`Invalid Git repository`

**检查项**：
- 确认路径正确，不能有多余的引号或空格
- 确认该目录下存在 `.git` 文件夹
- 尝试在该目录执行 `git status` 验证仓库有效性

### Q4: 下载文件失败？

**可能原因**：
- 磁盘空间不足
- 下载目录没有写入权限
- 防病毒软件拦截

**解决方法**：
- 检查磁盘空间
- 临时关闭防病毒软件
- 更换下载目录

---

## 🔧 开发调试

### 打开开发者工具

在 Electron 应用中按 **F12** 打开 Chrome DevTools。

### 查看日志

- **前端日志**：DevTools → Console 面板
- **后端日志**：启动 `dotnet run` 的终端窗口
- **主进程日志**：启动 `electron:start` 的终端窗口

### 热更新

修改前端代码后，Vite 会自动热更新，无需刷新页面。

修改 Electron 主进程代码后，需要：
1. 关闭 Electron 窗口
2. 重新运行 `npm run electron:start`

---

## 📚 更多文档

- **[完整 README](./README.MD)** - 详细的项目介绍和功能说明
- **[Electron 集成文档](./ELECTRON_INTEGRATION.md)** - 技术架构和实现细节

---

## 💡 小贴士

1. **性能优化**：首次打开大型仓库可能较慢，属正常现象
2. **快捷键**：
   - `Ctrl + R` - 刷新 Electron 窗口
   - `F12` - 开启/关闭开发者工具
   - `Ctrl + F` - 搜索（在页面内）
3. **批量操作**：使用 **Shift + 点击** 可快速选择连续的提交记录
4. **路径输入**：支持直接从文件资源管理器复制路径并粘贴

---

## 🎉 开始使用

现在您已经掌握了基本操作，开始管理您的 Git 仓库吧！

如有问题，请查阅 [README.MD](./README.MD) 或提交 Issue。

---

**祝使用愉快！ 🚀**
